(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{492:function(v,_,e){"use strict";e.r(_);var t=e(10),c=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"hmr-热更新原理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#hmr-热更新原理"}},[v._v("#")]),v._v(" HMR 热更新原理")]),v._v(" "),_("p",[v._v("在 "),_("code",[v._v("HMR")]),v._v(" 之前，应用的加载、更新都是一种页面级别的原子操作，即使只是单个代码文件发生变更，都需要刷新整个页面，才能将最新代码映射到浏览器上，这会丢失之前在页面执行过的所有交互与状态")]),v._v(" "),_("h2",{attrs:{id:"实现原理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#实现原理"}},[v._v("#")]),v._v(" 实现原理")]),v._v(" "),_("p",[_("code",[v._v("HMR")]),v._v(" 执行过程不复杂，核心：")]),v._v(" "),_("ul",[_("li",[v._v("使用 "),_("code",[v._v("webpack-dev-server")]),v._v(" （后面简称 WDS）托管静态资源，同时以 "),_("code",[v._v("Runtime")]),v._v(" 方式注入一段处理 "),_("code",[v._v("HMR")]),v._v(" 逻辑的客户端代码；")]),v._v(" "),_("li",[v._v("浏览器加载页面后，与 "),_("code",[v._v("WDS")]),v._v(" 建立 "),_("code",[v._v("WebSocket")]),v._v(" 连接；")]),v._v(" "),_("li",[_("code",[v._v("Webpack")]),v._v(" 监听到文件变化后，增量构建发生变更的模块，并通过 "),_("code",[v._v("WebSocket")]),v._v(" 发送 "),_("code",[v._v("hash")]),v._v(" 事件；")]),v._v(" "),_("li",[v._v("浏览器接收到 "),_("code",[v._v("hash")]),v._v(" 事件后，请求 "),_("code",[v._v("manifest")]),v._v(" 资源文件，确认增量变更范围；")]),v._v(" "),_("li",[v._v("浏览器加载发生变更的增量模块；")]),v._v(" "),_("li",[_("code",[v._v("Webpack")]),v._v(" 运行时触发变更模块的 "),_("code",[v._v("module.hot.accept")]),v._v(" 回调，执行代码变更逻辑；")])]),v._v(" "),_("h2",{attrs:{id:"总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[v._v("#")]),v._v(" 总结")]),v._v(" "),_("p",[_("code",[v._v("Webpack")]),v._v(" 的 "),_("code",[v._v("HMR")]),v._v(" 特性底层有两个重点：\n一是监听文件变化并通过 "),_("code",[v._v("WebSocket")]),v._v(" 发送变更消息；\n二是需要客户端配合，通过 "),_("code",[v._v("module.hot.accept")]),v._v(" 接口定制特定模块的热替换规则。")])])}),[],!1,null,null,null);_.default=c.exports}}]);