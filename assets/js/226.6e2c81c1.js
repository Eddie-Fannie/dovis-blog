(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{497:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"认识commonjs规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#认识commonjs规范"}},[s._v("#")]),s._v(" 认识CommonJS规范")]),s._v(" "),t("blockquote",[t("p",[s._v("运行时加载，因为只有运行时才能得到"),t("code",[s._v("require")]),s._v("的对象，完全没有办法在编译时进行“静态优化”")])]),s._v(" "),t("ol",[t("li",[t("p",[t("code",[s._v("CommonJS")]),s._v("中规定每个文件是一个模块。将一个JavaScript文件直接通过"),t("code",[s._v("script")]),s._v("标签插入页面中与封装成"),t("code",[s._v("CommonJS")]),s._v("模块最大的不同在于，前者的顶层作用域是全局作用域，在进行变量及函数声明时会污染全局环境；而后者会形成一个属于模块自身的作用域，所有的变量及函数只有自己能访问，对外是不可见的。")])]),s._v(" "),t("li",[t("p",[s._v("在"),t("code",[s._v("CommonJS")]),s._v("中通过"),t("code",[s._v("module.exports")]),s._v("可以导出模块中的内容，模块内部会有一个"),t("code",[s._v("module")]),s._v("对象用于存放当前模块的信息。"),t("strong",[s._v("例子：")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'calculater'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 简化书写（不推荐）")]),s._v("\nexports"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'calculater'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nexports"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("在使用"),t("code",[s._v("exports")]),s._v("时要注意不要直接给"),t("code",[s._v("exports")]),s._v("赋值，否则会导致失效：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'calculater'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 上面的代码由于对exports进行赋值操作，使其指向了新的对象，module.exports却仍然是原来的空对象，因此name属性并不会被导出。")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("commonJS")]),s._v("用同步的方式加载模块。在服务端，模块文件都存在本地磁盘，读取非常快，所以这样做不会有问题。但是在浏览器端，限于网络原因，更合理的方案是使用异步加载。")])]),s._v(" "),t("li",[t("p",[s._v("当我们"),t("code",[s._v("require")]),s._v("一个模块时会有两个情况：")])])]),s._v(" "),t("blockquote",[t("p",[t("code",[s._v("require")]),s._v("是Node的语法，浏览器无法识别。运行时加载模块，具有动态加载的功能。")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("require")]),s._v("模块第一次被加载。这时会首先执行该模块，然后导出内容。")]),s._v(" "),t("li",[t("code",[s._v("require")]),s._v("的模块曾被加载过。这时模块的代码不会再次执行，而是直接导出上次执行后得到的结果。")])]),s._v(" "),t("h2",{attrs:{id:"commonjs模块化的特点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#commonjs模块化的特点"}},[s._v("#")]),s._v(" CommonJS模块化的特点：")]),s._v(" "),t("ul",[t("li",[s._v("加载机制：输入的是被输出的值的拷贝，也就是说：一旦输出一个值，模块内部的变化就影响不到这个值。")]),s._v(" "),t("li",[s._v("所有代码都运行在模块作用域，不会污染全局作用域")]),s._v(" "),t("li",[s._v("模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了，以后再加载，就直接读取缓存结果。要想让模块再次运行，必须清除缓存。")]),s._v(" "),t("li",[s._v("模块加载顺序，按照其在代码中出现的顺序。")])]),s._v(" "),t("p",[s._v("同步加载代码，在浏览器会发生堵塞问题，造成页面无响应，所以浏览器不太适合用"),t("code",[s._v("CommonJS")]),s._v("来加载。")]),s._v(" "),t("ul",[t("li",[s._v("CommonJS规范对浏览器和服务器端的不同之处：\n"),t("ul",[t("li",[s._v("服务器端所有的模块都存放在本地硬盘中，同步加载完成才能执行后续操作，等待时间就是硬盘的读取时间。")]),s._v(" "),t("li",[s._v("浏览器，所有的模块都放在服务器端，等待时间取决于网速的快慢，可能要等很长时间，浏览器处于”假死”状态。")])])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("ol",[t("li",[s._v("每一个文件就是一个模块，拥有自己独立的作用域，变量，以及方法等，对其他的模块都不可见。"),t("code",[s._v("CommonJS")]),s._v("规范规定：每个模块内部，"),t("code",[s._v("module")]),s._v("变量代表当前模块。这个变量是一个对象，它的"),t("code",[s._v("exports")]),s._v("属性（即"),t("code",[s._v("module.exports")]),s._v("）是对外的接口。加载某个模块，其实是加载该模块的"),t("code",[s._v("module.exports")]),s._v("属性。"),t("code",[s._v("require")]),s._v("方法用于加载模块。")]),s._v(" "),t("li",[s._v("模块加载的顺序按照其在代码中出现的顺序")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);