(window.webpackJsonp=window.webpackJsonp||[]).push([[211],{485:function(v,_,e){"use strict";e.r(_);var o=e(10),c=Object(o.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"plugin-原理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#plugin-原理"}},[v._v("#")]),v._v(" plugin 原理")]),v._v(" "),_("h2",{attrs:{id:"plugin-思路"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#plugin-思路"}},[v._v("#")]),v._v(" plugin 思路")]),v._v(" "),_("p",[_("code",[v._v("webpack")]),v._v(" 在运行的生命周期中会广播出许多事件，"),_("code",[v._v("Plugin")]),v._v(" 可以监听这些事件，在特定的阶段钩入想要添加的自定义功能。"),_("code",[v._v("Webpack")]),v._v(" 的 "),_("code",[v._v("Tapable")]),v._v(" 事件流机制保证了插件的有序性，使得整个系统扩展性良好。")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("Compiler")]),v._v(" 对象包含了 "),_("code",[v._v("Webpack")]),v._v(" 环境所有的配置信息，包含 "),_("code",[v._v("options")]),v._v("，"),_("code",[v._v("loaders")]),v._v("，"),_("code",[v._v("plugins")]),v._v(" 这些信息，这个对象在 "),_("code",[v._v("Webpack")]),v._v(" 启动时候被实例化，它是全局唯一的，可以简单地把它理解为 "),_("code",[v._v("Webpack")]),v._v(" 实例；")]),v._v(" "),_("li",[_("code",[v._v("Compilation")]),v._v(" 对象包含了当前的模块资源、编译生成资源、变化的文件等。当 "),_("code",[v._v("Webpack")]),v._v(" 以开发模式运行时，每当检测到一个文件变化，一次新的 "),_("code",[v._v("Compilation")]),v._v(" 将被创建。"),_("code",[v._v("Compilation")]),v._v(" 对象也提供了很多事件回调供插件做扩展。通过 "),_("code",[v._v("Compilation")]),v._v(" 也能读取到 "),_("code",[v._v("Compiler")]),v._v(" 对象。")]),v._v(" "),_("li",[v._v("插件需要在其原型上绑定 "),_("code",[v._v("apply")]),v._v(" 方法，才能访问 "),_("code",[v._v("compiler")]),v._v(" 实例")]),v._v(" "),_("li",[v._v("传给每个插件的 "),_("code",[v._v("compiler")]),v._v(" 和 "),_("code",[v._v("compilation")]),v._v(" 对象都是同一个引用，若在一个插件中修改了它们身上的属性，会影响后面的插件。")])]),v._v(" "),_("ul",[_("li",[v._v("找出合适的事件点去完成想要的功能：\n"),_("ul",[_("li",[_("code",[v._v("emit")]),v._v(" 事件发生时，可以读取到最终输出的资源、代码块、模块及其依赖，并进行修改("),_("code",[v._v("emit")]),v._v(" 事件是修改 "),_("code",[v._v("Webpack")]),v._v(" 输出资源的最后时机)")]),v._v(" "),_("li",[_("code",[v._v("watch-run")]),v._v(" 当依赖的文件发生变化时会触发")])])])]),v._v(" "),_("ul",[_("li",[v._v("异步的事件需要在插件处理完任务时调用回调函数通知 "),_("code",[v._v("Webpack")]),v._v(" 进入下一个流程，不然会卡住。")])])])}),[],!1,null,null,null);_.default=c.exports}}]);