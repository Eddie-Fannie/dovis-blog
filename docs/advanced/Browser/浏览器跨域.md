# 跨域问题知多少
> 协议，端口和主机不是相同的，则跨域。其实主要是用来防止 `CSRF` 攻击的。简单点说，`CSRF` 攻击是利用用户的登录态发起恶意请求。

## `JSONP`
```js
function jsonp(url, jsonpCallback, success) {
  let script = document.createElement('script')
  script.src = url
  script.async = true
  script.type = 'text/javascript'
  window[jsonpCallback] = function(data) {
    success && success(data)
  }
  document.body.appendChild(script)
}
jsonp('http://xxx', 'callback', function(value) {
  console.log(value)
})
```

## `CORS`
服务端设置`Access-Control-Allow-Origin`就可以开启`CORS`。该属性表示哪些域名可以访问资源，如果设置通配符表示所有网站都可以访问资源。虽然设置`CORS `和前端没什么关系，但是通过这种方式解决跨域问题的话，会在发送请求时出现两种情况，分别为简单请求和复杂请求。

- **简单请求**
1. 方法 `get post head`
2. `Content-Type`仅限：`text/plain,multipart/form-data,application/x-www-form-urlencoded`

- **复杂请求**
> 对于复杂请求来说，首先会发起一个预检请求，该请求是`option`方法的，通过该请求来知道服务端是否允许跨域请求。

## `document.domain`
> 该方式只能用于二级域名相同的情况下，比如`a.test.com`和`b.test.com`。只需要给页面添加`document.domain = 'test.com'`表示二级域名相同就可以实现跨域。

## `devServer` vue项目
> 跨域是浏览器禁止的，服务端并不禁止跨域，所以浏览器可以发给自己的服务端然后由自己的服务端再转发给要跨域的服务端，做一层代理。`vue-cli`的`proxy`用的就是`http-proxy-middleware`中间件，`http-proxy-middleware`内部用`http-proxy`