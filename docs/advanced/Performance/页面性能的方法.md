# 页面性能优化的方法
+ 前端性能优化的核心
    - 减少`http`请求数量
    - 减少请求资源的大小
    
1. `html/css/js`压缩
> `html`代码压缩就是压缩一些文本文件中有意义，但是在`HTML`中不显式的字符，包括空格，制表符，换行符等，还有一些其他意义的字符，如`html`注释也可以被压缩

+ 如何进行`html`压缩：
    - 使用在线网站进行压缩；
    - `node.js`提供的`html-minifier`工具
    - 后端的模板引擎渲染压缩

+ `css`代码压缩
    - 使用`html-minifier`对`html`中的`css`进行压缩；
    - 使用`clean-css`对`css`进行压缩；

+ `js`压缩与混乱（丑化）
    - 无效字符的删除（空格，回车等）
    - 删除注释
    - 使用`uglify.js2`对`js`进行压缩。

2. 合并请求
+ 不合并请求的缺点：
    - 文件和文件之间有插入的上行请求，会增加`N-1`个网络延迟
    - 受丢包问题的影响更严重：因为每次请求都可能出现丢包的情况，减少请求能有效减少丢包的情况。
    - `keep-alive`本身也存在问题：经过代理服务器时可能会断开。

+ 文件合并的问题：
    - 首屏渲染问题：当请求`js`文件的时候，如果页面渲染只依赖`a.js`文件，由于合并文件，需要等待合并后的`a-b-c.js`文件请求回来才能继续渲染，这样就会导致页面渲染速度变慢。
    - 缓存失效问题：合并后的文件`a-b-c.js`中只要其中一个文件（比如`a.js`）发生变化，那么整个合并文件都将失效，而不采用文件合并就不会出现这种情况；

+ 使用建议
    - 公共库合并：将不经常发生变化的公共组件库文件合并；
    - 将不同页面的`js`文件单独合并：比如在单页面应用`SPA`中，当路由跳转到具体页面时才请求该页面需要的`js`文件；

3. 图片相关的优化
    - 

4. 使用`CDN`
> 大型`Web`应用对速度的追求并没有止步于仅仅利用浏览器缓存，因为浏览器缓存始终只是为了提升二次访问的速度，对于首次访问的加速，我们需要从网络层面进行优化，最常见的手段就是`CDN`（`Content Delivery Network`，内容分发网络）加速。通过将静态资源(例如`javascript`，`css`，图片等等）缓存到离用户很近的相同网络运营商的`CDN`节点上，不但能提升用户的访问速度，还能节省服务器的带宽消耗，降低负载。

::: tip
`CDN`怎么做到加速的呢？
> 其实这是`CDN`服务商在全国各个省份部署计算节点，`CDN`加速将网站的内容缓存在网络边缘,不同地区的用户就会访问到离自己最近的相同网络线路上的`CDN`节点，当请求达到`CDN`节点后，节点会判断自己的内容缓存是否有效，如果有效，则立即响应缓存内容给用户，从而加快响应速度。如果`CDN`节点的缓存失效，它会根据服务配置去我们的内容源服务器获取最新的资源响应给用户，并将内容缓存下来以便响应给后续访问的用户。因此，一个地区内只要有一个用户先加载资源，在`CDN`中建立了缓存，该地区的其他后续用户都能因此而受益。
:::
    