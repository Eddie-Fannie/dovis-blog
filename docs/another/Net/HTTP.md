# HTTP
> `HTTP`是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。
## 报文
`HTTP`报文分为两种：`HTTP`请求报文（请求行-`HTTP`头（通用信息头，请求头，实体头）-请求报文主体（只有`POST`才有报文主体）。响应报文则相对应的为状态行，响应报文主体。
> 通用信息头指的是请求和响应报文都支持的头域，分别为`Cache-Control`、`Connection`、`Date`、`Pragma`、`Transfer-Encoding`、`Upgrade`、`Via`；实体头则是实体信息的实体头域，分别为`Allow`、`Content-Base`、`Content-Encoding`、`Content-Language`、`Content-Length`、`Content-Location`、`Content-MD5`、`Content-Range`、`Content-Type`、`Etag`、`Expires`、`Last-Modified`、`extension-header`。

**常用头部字段解释：**
![img](/dovis-blog/other/18.png)

## HTTP历史
- `HTTP/0.9`
> 只有一个请求行，没有`HTTP`请求头和请求体。同样，服务器也没有响应头信息，只是返回了数据。因为都是`HTML`格式的文件，决定了返回的文件内容通过`ASCII`字符流进行传输。
- `HTTP/1.0`
> 引入请求头/响应头，引入状态码，为了减轻服务器压力提供了`Cache`机制。服务器需要统计客户端的基础信息(Windows 和 macOS)，加入了用户代理字段。
- `HTTP/1.1`
::: tip
1. 改进持久连接
一个`TCP`连接上可以传输多个`HTTP`请求，只要浏览器或者服务器没有断开连接，该`TCP`会一直保持。持久连接是默认开启的，如果想要关闭，在请求头中加上`Connection:close`即可关闭。目前浏览器中对于同一个域名，默认允许同时建立`6`个`TCP`持久连接。

2. 增加对虚拟主机的支持
> `HTTP/1.0`中每个域名都只绑定唯一的`IP`地址，因此一个服务器只能支持一个域名。但是随着虚拟主机技术的发展，一台物理主机上绑定多个虚拟主机的需求大大提升，每个虚拟主机都有自己单独的域名，这些单独的域名都公用同一个`IP`地址。因此，请求头中也增加了`Host`字段，表示当前的域名地址，服务器可根据不同的`Host`值做不同的处理。

3. 增加对动态生产内容的支持
> `HTTP/1.0`需要在响应头中设置完整的数据大小`Content-Length：900`，这样，浏览器就可以根据设置的数据大小来接收数据。由于服务器端技术发展，页面都是动态生成的，传输数据之前并不知道最终数据大小，导致浏览器不知道何时会接受完所有的文件数据。`HTTP/1.1`通过引入`Chunk transfer`机制来解决问题，服务器将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上一个数据块的长度，最后使用一个长度为`0`的块作为发送数据完成的标志。

4. 客户端`Cookie`，安全机制
:::

- `HTTP/2.0`
> 使用多路复用机制解决`TCP`慢启动；开启多条`TCP`连接会竞争固定带宽；队头阻塞的问题。（**一个域名只使用一个 `TCP` 长连接和消除队头阻塞问题。通过引入二进制分帧层，实现了 `HTTP` 的多路复用技术。**）

> 服务器可以提前将数据推送到浏览器，浏览器有权选择是否接受。浏览器发送`RST_STREAM`帧可以选择拒收。

> 头部的压缩大大的提升了传输效率。`HTTP/2`开发了“`HPACK`”算法，在客户端和服务器建立“字典”，用索引号表示重复的字符串，还采用哈夫曼编码来压缩整数和字符串。

> 可以设置让某些重要的数据优先被服务器处理并返回。

- `HTTP/3.0`
