# ğŸ¦çš®é¡¹ç›®æ€»ç»“

## ç¿»è¯‘å·¥å…·ï¼ˆé¡ºå¸¦çœ‹i18nå¼€æºåŸç†

### ä½¿ç”¨è¯´æ˜
ç”¨äºç”Ÿæˆè§„èŒƒç¿»è¯‘å‡½æ•°ï¼Œé…åˆé™æ€æ‰«æå·¥å…·æ”¶å½•ç¿»è¯‘keyå¹¶ä¸Šä¼ åˆ°ç¿»è¯‘å¹³å°

### åˆå§‹åŒ–
- ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ `npx ssc-tsf init`
- è¡¥å……é»˜è®¤é…ç½®æ–‡ä»¶ä¸­å¿…è¦çš„ä¿¡æ¯ï¼Œé¡¹ç›®å
- æ¥å…¥ç”Ÿæˆ`$gt`ç¿»è¯‘å‡½æ•°

```
// ä»¥vueé¡¹ç›®ä¸ºä¾‹
// generateTransifyCommon ç¿»è¯‘å·¥å…·å†…éƒ¨å‡½æ•°
export const $gt = generateTransifyCommon({
  t: (key, options) => i18n.t(key, options),
  project: 'pms'
});
Vue.prototype.$gt = $gt;
```
- é…ç½® `git hook` (å¤ä¹ pre-commit/post-commité’©å­åŒºåˆ«)
```
// package.json
{
  "gitHooks": {
    "pre-commit": "npx ssc-tsf update --cached && npx ssc-tsf download"
  }
}
```
> è¿™æ ·åœ¨æäº¤ä»£ç æ—¶å³ä¼šè‡ªåŠ¨æ”¶é›†ç¿»è¯‘key-valueåˆ°ç¿»è¯‘å¹³å°

### æ³¨æ„äº‹é¡¹
1. éœ€è¦ä¿ç•™è‡ªå®šä¹‰ `key` æ—¶ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨åŸæœ¬çš„`$t` ï¼ˆå¤ä¹ `i18n`ï¼‰
2. é¿å…åœ¨åŸæ¥ `key` å€¼ä¸Šä¿®æ”¹æ–‡æ¡ˆï¼ˆé™æ€æ‰«æå·¥å…·æ£€æµ‹åˆ°ç›¸åŒ `key` ä½†ç¿»è¯‘æ–‡æ¡ˆä¸åŒæ—¶ä¼šæŠ¥å†²çªï¼‰
3. `$gt` å¿…é¡»ç›´æ¥ä¼ å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä½¿ç”¨å˜é‡ï¼Œå¦åˆ™é™æ€å·¥å…·æ— æ³•æ‰«æåˆ°å‚æ•°
4. æ³¨é‡Šä¸­å«æœ‰ `$gt` ä¾ç„¶ä¼šè¢«æ‰«æä¸Šä¼ 

### APIä½¿ç”¨
#### `GenerateFunction`
è§„èŒƒç¿»è¯‘å‡½æ•°çš„ç±»å‹ï¼ˆ`$gt`)

$gt(label, namespace, options): string

| å‚æ•°      | ç±»å‹         | æ˜¯å¦å¿…é¡»              | è¯´æ˜                                          |
| --------- | ------------ | --------------------- | --------------------------------------------- |
| label     | string       | æ˜¯                    | ç¿»è¯‘é»˜è®¤æ–‡æ¡ˆ                                  |
| namespace | string\|null | éœ€è¦ä¼  options æ—¶å¿…å¡« | åŒºåˆ†ç›¸åŒ label ä¸åŒå«ä¹‰ï¼Œ ç”¨äºè§£å†³ label å†²çª |
| options   | any          | å¦                    | é€ä¼ ç»™åŸå§‹ç¿»è¯‘å·¥å…·ï¼ˆæ¯”å¦‚ vue-i18nï¼‰çš„æ‰©å±•å‚æ•° |

#### `generateTransifyCommon`
ç”Ÿæˆè§„èŒƒç¿»è¯‘å‡½æ•°
generateTransifyCommon(config: CommonConfig): GenerateFunction

CommonConfig å‚æ•°è¯´æ˜ï¼š

| å‚æ•°      | ç±»å‹     | æ˜¯å¦å¿…é¡» | è¯´æ˜                                                                          |
| --------- | -------- | -------- | ----------------------------------------------------------------------------- |
| t         | function | æ˜¯       | ç¿»è¯‘å‡½æ•°ï¼š(key: string, options: any) => string;                              |
| project   | string   | æ˜¯       | é¡¹ç›®åç§°ï¼Œå’Œç¿»è¯‘å·¥å…·çš„é…ç½®:`transify.config.js`å¿…é¡»ä¸€è‡´                       |
| isShowKey | boolean  | å¦       | æ˜¯å¦å§‹ç»ˆæ˜¾ç¤º keyï¼Œå¯ç”¨äºå¼€å‘è°ƒè¯•ï¼Œé»˜è®¤ falseï¼Œæ˜¾ç¤º key å—`useSSCTransify`æ§åˆ¶ |

#### `useSSCTransify`
æ˜¾ç¤º `key` çš„è¾…åŠ©æ’ä»¶ï¼Œæ¥å…¥åä¼šåœ¨é¡µé¢ `body` ä¸­æ’å…¥`show key`æŒ‰é’®ï¼Œå¯ä»¥å¿«æ·åˆ‡æ¢æ˜¾ç¤º `key` å’Œæ˜¾ç¤ºç¿»è¯‘

useSSCTransify(changeLanguage: ChangeLanguage, getLanguage: GetLanguage): void

| å‚æ•°           | ç±»å‹     | æ˜¯å¦å¿…é¡» | è¯´æ˜                                   |
| -------------- | -------- | -------- | -------------------------------------- |
| ChangeLanguage | function | æ˜¯       | (lang: string) => void; åˆ‡æ¢å›½é™…åŒ–è¯­è¨€ |
| GetLanguage    | function | æ˜¯       | () => string; è·å–å½“å‰å›½é™…åŒ–è¯­è¨€       |

### ç¿»è¯‘å·¥å…·å‘½ä»¤ç«¯åˆ†æ

### åŸç†ç»†è¯´
1. `blueimp-md5`ç”Ÿæˆ32ä½ æœ€ç»ˆä½¿ç”¨slice(8, 24)æˆªå–äº†16ä½æ¥ä½œä¸º`key`
:::tip
`key`ç”± `Project`,`NameSpace`,`Label`åŠ _æ‹¼æ¥ç»„æˆï¼Œæ‰€æœ‰ç©ºæ ¼æ›¿æ¢ä¸º`_`

- ç¼©å°å¹³å‡é•¿åº¦ï¼šæ ¹æ®å®é™…æ•°æ®ç»Ÿè®¡ï¼Œç”Ÿæˆçš„è§„èŒƒ label å¹³å‡é•¿åº¦åœ¨ 25 ä»¥ä¸Šï¼Œè€Œä¸”å­˜åœ¨ä¸ªåˆ«è¶…é•¿é•¿åº¦ä¼šå½±å“æ•°æ®è¾¹ç•Œ
- ä¿è¯å”¯ä¸€æ€§ï¼šé‡‡ç”¨ `md5` ç®—æ³•æ˜¯ä¸ºäº†ä¿è¯å”¯ä¸€æ€§ï¼Œé¿å…å†²çª
- æ˜“äºåŒºåˆ†ï¼šå·¥å…·ç”Ÿæˆçš„ `key` ç»Ÿä¸€ä¸º 16 ä½ `MD5`ï¼Œç‰¹å¾æ¯”è¾ƒæ˜æ˜¾ï¼Œä¾¿äºåç»­å·¥å…·åˆ†æå’ŒåŒºåˆ†
:::

2. é¡¹ç›®å_keyçš„æ¨¡å—åç§°ï¼ˆé»˜è®¤otherï¼‰_labelï¼ˆéœ€è¦ç¿»è¯‘çš„æ–‡æ¡ˆï¼‰ç”¨æ¥ç”Ÿæˆkeyã€‚æ¨¡å—åç§°æ˜¯æŒ‡å¯èƒ½åŒä¸€ä¸ªæ–‡æ¡ˆlabelåœ¨ä¸åŒæ¨¡å—ä¸‹ç¿»è¯‘å«ä¹‰å¯èƒ½æœ‰æ‰€ä¸åŒ

## zoneç”µå­å›´æ 
éš¾ç‚¹æ¨¡å—ï¼šundoã€redoï¼Œç²¾å‡†çš„å¸é™„ã€è´´è¾¹çš„å¤„ç†ã€è¾¹ç•Œçš„åˆ‡å‰²ã€splitã€mergeã€ç»˜åˆ¶

æ•´ä½“ç»“æ„ -- ä¸»è¦åŠŸèƒ½æ¨¡å—ä¸åˆå§‹åŒ–
`DrawingManger`ï¼šç®¡ç†ç»˜åˆ¶ã€ç¼–è¾‘ã€åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªzoneå¤šè¾¹å½¢çš„çŠ¶æ€ã€æ–¹æ³•
`EventManager`ï¼šç®¡ç†æ‰€æœ‰åœ°å›¾ã€åŠåœ°å›¾ä¸­å›¾å½¢çš„ç›‘å¬äº‹ä»¶
`ActionLogManager`ï¼š ç®¡ç†æ‰€æœ‰Zoneç»˜åˆ¶è¿‡ç¨‹ä¸­çš„æ“ä½œè®°å½•Logï¼ŒåŠç›¸å…³æ•°æ®çš„ç»Ÿä¸€å¤„ç†
`UndoRedoManager`ï¼šç®¡ç†UndoRedoæ“ä½œæ¶‰åŠçš„çŠ¶æ€ã€æ–¹æ³•

### è’™å±‚ä¸å¯ç¼–è¾‘åŒºåŸŸ
è§£å†³æ–¹æ¡ˆï¼š
1. é™åˆ¶åœ°å›¾çš„æœ€å°ç¼©æ”¾çº§åˆ«ã€é¿å…ç”¨æˆ·çœ‹åˆ°è’™å±‚è¾¹ç¼˜
2. ç›‘å¬åœ°å›¾çš„`dragend`äº‹ä»¶ï¼Œå°†å¯è§†åŒºåŸŸæ§åˆ¶åœ¨ç”»Zoneçš„æœ‰æ•ˆåŒºåŸŸé™„è¿‘
3. åˆ©ç”¨äº†`GeoJSON`ä¸­æœ‰å­”çš„`Polygon`ä½œä¸ºè’™å±‚ï¼Œå­”çš„åŒºåŸŸä½œä¸ºç”»`Zone`çš„æœ‰æ•ˆåŒºåŸŸ

:::tip
æœ‰å­”`polygon`ï¼š
- å†…éƒ¨æœ‰å¤šè¾¹å½¢å­”çš„`Polygon`å¤šè¾¹å½¢ï¼Œç¬¬äºŒä¸ªæ•°ç»„æ‰€æè¿°çš„å°±æ˜¯å¤šè¾¹å½¢å†…å­”
- ä½œä¸ºå­”çš„å¤šè¾¹å½¢ï¼Œå„ç‚¹çš„åæ ‡éœ€æŒ‰é€†æ—¶é’ˆé¡ºåº
:::

### ç»˜å›¾
ä½¿ç”¨`google map`æä¾›çš„`Drawing Tools`å°è£…äº†ä¸€ä¸ªå›¾å½¢ç»˜åˆ¶çš„æ•´ä½“è¿‡ç¨‹ï¼Œåªæš´éœ²äº†ç»˜åˆ¶å®Œæˆçš„äº‹ä»¶ã€‚è€Œç”µå­å›´æ æ¨¡å—çš„éœ€æ±‚ä¸­ï¼Œå¯¹äºå›¾å½¢ç»˜åˆ¶çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡çš„è½ç‚¹éƒ½æœ‰äº¤äº’å’Œå¤„ç†çš„é€»è¾‘ï¼Œæ‰€ä»¥æ²¡æ³•åº”ç”¨

#### Add Zone
#### åˆå§‹

åˆå§‹åŒ–Polylineå’ŒPolygonï¼Œç»˜åˆ¶è¿‡ç¨‹ä¸­ï¼Œæ›´æ–°Zoneçš„Polylineä»¥åŠPolygonçš„æ•°æ®ï¼Œæ¸²æŸ“æ›´æ–°çš„Polylineåˆ°åœ°å›¾ã€‚ç»˜åˆ¶å®Œæˆæ—¶ï¼Œæ¸²æŸ“Zoneçš„Polygonåˆ°åœ°å›¾ã€‚

å„åˆå§‹åŒ–çš„ä»»åŠ¡ï¼š
1. åˆå§‹åŒ–DrawingManagerï¼Œåˆ›å»ºæ–°çš„Zoneè½¨è¿¹çš„PolyLineå’ŒZoneå›¾å½¢çš„Polygonå¯¹è±¡
2. åˆå§‹åŒ–UndoRedoManagerï¼Œå‡†å¤‡åç»­è®°å½•ç”¨æˆ·çš„ç»˜å›¾æ“ä½œ
3. åˆå§‹åŒ–å„ä¸ªAddè¿‡ç¨‹ä¸­çš„äº¤äº’åŠŸèƒ½çš„äº‹ä»¶æ³¨å†Œã€‚åŒ…æ‹¬ï¼š
a. è½ç‚¹æ—¶ï¼Œæ›´æ–°Zoneçš„è½¨è¿¹çº¿Polyline
b. é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œæ¸²æŸ“å¼•çº¿ï¼Œæç¤ºæ¡†
c. é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œå¯»æ‰¾ï¼Œè®¡ç®—å’Œæ˜¾ç¤ºè‡ªåŠ¨å¸é™„ç‚¹
d. é¼ æ ‡ç§»å…¥ç§»å‡ºæœ‰æ•ˆåŒºåŸŸæ—¶çš„å¤„ç†
e. é¼ æ ‡åŒå‡»æ—¶ï¼Œå®ŒæˆZoneçš„é—­åˆå’Œç»˜åˆ¶
f. drag/dropç°æœ‰çš„ç‚¹æ—¶ï¼Œæ›´æ–°è¯¥ç‚¹çš„ä½ç½®
g. å³é”®ç‚¹å‡»ç°æœ‰çš„ç‚¹æ—¶ï¼Œæä¾›å¯ä»¥åˆ é™¤è¯¥ç‚¹çš„é€‰é¡¹

##### è¾¹çš„è‡ªåŠ¨å¸é™„
1. addæ“ä½œè¿‡ç¨‹ä¸­ï¼Œå§‹ç»ˆæœ‰å¼•çº¿è·Ÿéšï¼Œå½“å¼•çº¿æ¥è¿‘ç»˜åˆ¶åŒºåŸŸè¾¹ç•Œã€æˆ–æ˜¯å…¶ä»–zoneçš„è¾¹ç•Œæ—¶ï¼Œä¼šè‡ªåŠ¨å¸é™„åˆ°è¯¥è¾¹ä¸Šã€‚
2. é€šè¿‡Map APIæä¾›çš„`isLocationOnEdge`æ–¹æ³•
3. ä½†æ˜¯è¿™ä¸ªæ— æ³•ä¿è¯ç²¾ç¡®åº¦ï¼Œæä¾›ç‚¹buffer
4. æ‰¾åˆ°bufferå†…çš„ç‚¹åï¼Œé€šè¿‡å‡ ä½•è®¡ç®—ï¼Œæ‰¾åˆ°ä¸´è¿‘çš„è¾¹ä¸Šè·ç¦»ç›®æ ‡ç‚¹æœ€æ–°çš„ç‚¹ï¼ˆæ¶‰åŠ**å¢¨å¡æ‰˜åæ ‡ç³»è½¬æ¢**ï¼‰

#### åˆ‡è¾¹å¤„ç†
ç»˜åˆ¶å®Œæˆåæäº¤æ•°æ®ï¼Œåç«¯å¯¹æäº¤çš„polygonæ•°æ®ä¸æœåŠ¡èŒƒå›´è¾¹ç•Œè¿›è¡Œè®¡ç®—ï¼Œå»æ‰è¾¹ç•Œå¤–çš„éƒ¨åˆ†

#### Split zone
å¯¹æ¯”å¼•çº¿åªèƒ½åœ¨è¾¹ä¸Šï¼Œè·Ÿè¶…å‡ºzoneè¾¹ç•Œçš„ä¸¤ç§äº¤äº’çš„å®ç°

- **éå†zoneå›¾å½¢æ‰€æœ‰ç‚¹ï¼Œä»¥splitçº¿çš„ç‚¹ä¸ºåˆ†ç•Œçº¿ï¼Œå°†ä¸¤ä¾§ç‚¹åˆ†åˆ«åŠ å…¥åˆ°ä¸¤ä¸ªæ–°çš„zoneå›¾å½¢ä¸­ï¼Œå¹¶é€šè¿‡åæ ‡ç‚¹æ—‹è½¬ä»¥é¿å…å¤šè¾¹å½¢å‡ºç°å­”çš„æƒ…å†µ**ã€‚

#### merge zone
ç°æœ‰æ–¹æ¡ˆäº¤ç»™åå°å¤„ç†

## webpack æ„å»ºä¼˜åŒ–
- å¼€å‘æ„å»ºæ—¶ä¼šç¼–è¯‘æ‰€æœ‰é¡µé¢ï¼Œä½†æ˜¯å¼€å‘å¯èƒ½åªå…³æ³¨è‹¥å¹²é¡µé¢
- ç¼ºå°‘ç¼–è¯‘ç¼“å­˜
- å•çº¿ç¨‹

:::tip
`webpack`ä»v4å‡çº§åˆ°v5ï¼Œç”±äºå‡çº§äº† `webpack`ï¼Œ`webpack-cli`ï¼Œ`plugin` ä»¥åŠ `loader` çš„ç‰ˆæœ¬ï¼Œå› æ­¤ï¼Œå¯èƒ½ä¼šå‡ºç°æ–°çš„é”™è¯¯æˆ–è­¦å‘Šã€‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è¯·æ³¨æ„æ˜¯å¦æœ‰å¼ƒç”¨è­¦å‘Šã€‚

ä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è°ƒç”¨ `webpack` æ¥è·å–å †æ ˆä¿¡æ¯ä¸­çš„å¼ƒç”¨è­¦å‘Šï¼Œä»è€Œæ‰¾å‡ºæ˜¯å“ªä¸ª `plugin` æˆ– `loader` é€ æˆçš„ã€‚
```
node --trace-deprecation node_modules/webpack/bin/webpack.js
```
:::

### `thread-loader`æ’ä»¶ï¼Œå¤šçº¿ç¨‹æ„å»º

çº¿ç¨‹æ± çº¿ç¨‹æ•°é‡ï¼Œç°ä»£è®¡ç®—æœºä¸€èˆ¬æœ‰å¤šä¸ªæ ¸ï¼Œä¸»çº¿ç¨‹å ä¸€ä¸ªæ ¸ï¼Œå‰©ä¸‹çš„æ ¸æˆ‘ä»¬æŠŠå¤§çº¦ä¸€åŠåˆ†ç»™ `vue` æ¨¡å—ï¼Œå‰©ä½™åˆ†ç»™ `js` æ¨¡å—ï¼Œ
å‡è®¾è®¡ç®—æœºæ ¸æ•°ä¸º `cpuCount` ï¼Œ
- åœ¨ `vue` æ¨¡å—é…ç½®ä¸­ï¼Œ`workersForVue = Math.max(1, Math.floor((cpuCount - 1)/2 - 1))`
- åœ¨ `js` æ¨¡å—é…ç½®ä¸­ï¼Œ`workersForJs = Math.max(1, cpuCount - workersForVue)`

### `cache-loader`ï¼Œå¢åŠ ç¼–è¯‘ç¼“å­˜
> å®‰è£… `cache-loader` ï¼Œåœ¨å¼€å‘ç¯å¢ƒé…ç½®é‡Œçš„ `vue-loader` å’Œ `babel-loader` åŠ ä¸Šç¼“å­˜ç›¸å…³é…ç½®é¡¹

é…ç½®é¡¹

| loader | options |
| ----- | ---- |
| vue-loader | { cacheDirectory: `node_modules/.cache-${userName}/vue-loader`, <br /> cacheIdentifier: getCacheIdentifier(envIndentifier, ['cache-loader', 'vue-loader']), } |
| babel-loader | { cacheDirectory: `node_modules/.cache-${userName}/babel-loader`, <br /> cacheIdentifier: getCacheIdentifier(envIndentifier, ['cache-loader', 'babel-loader', 'acribus', 'acribus-core']), } |

:::tip
1. `userName` ä¸ºå½“å‰ç”¨æˆ·åï¼Œå¼€å‘è¿‡ç¨‹å¯èƒ½ä½¿ç”¨ `sudo`è¿›è¡Œæ„å»ºï¼Œä¸åŒç”¨æˆ·ä½¿ç”¨ä¸åŒç¼“å­˜ç›®å½•ï¼Œ`sudo`ä¸‹`userName`ä¸º`root`ã€‚

```js
const os = require('os');

const userName = os.userInfo().username;
```

2. `getCacheIdentifier` æ˜¯ç”Ÿæˆç¼“å­˜æ ‡è¯†ï¼ˆ`cacheIdentifier`ï¼‰çš„å‡½æ•°ï¼Œç¼“å­˜æ ‡è¯†ç”¨äºä¸å•ä¸ªæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸€èµ·ç”Ÿæˆè¯¥æ–‡ä»¶çš„ç¼“å­˜æ ‡è¯†ã€‚
ä»£ç å‚è€ƒï¼š[create-react-app/packages/react-dev-utils](https://github.com/facebook/create-react-app/blob/bb64e31a81eb12d688c14713dce812143688750a/packages/react-dev-utils/getCacheIdentifier.js)
3. `envIndentifier` ä¸ºç¯å¢ƒå˜é‡æ ‡è¯†ï¼Œå½“ç¯å¢ƒå˜é‡å˜æ›´çš„æ—¶å€™ï¼Œç¼“å­˜åº”è¯¥å¤±æ•ˆï¼Œæ‰€ä»¥ç¼“å­˜æ ‡è¯†ä¸ç¯å¢ƒå˜é‡ç›¸å…³ã€‚

```js
const envIndentifier = `${FTE}-${ENV}-${mode}` // FTE ç¯å¢ƒå˜é‡ è¡¨ç¤ºå½“å‰æ„å»ºç¯å¢ƒï¼Œtest/uat/staging...,ENV ç¯å¢ƒå˜é‡è¡¨ç¤ºå½“å‰å“ªä¸ªå¸‚åœºï¼Œid/th/my/ph/tw/br... modeæ„å»ºæ¨¡å¼ï¼ˆdevelopment)
```
:::

### å‡çº§åˆ° `webpack5`ï¼Œåˆ©ç”¨ `webpack5`çš„æ¨¡å—è”é‚¦ ï¼ˆ`module federation`ï¼‰åŠŸèƒ½ï¼Œè¿›è¡Œæ¨¡å—æ‹†åˆ†ï¼Œè®©æ¨¡å—ç‹¬ç«‹ç¼–è¯‘å’Œç»´æŠ¤
1. æå‡å¼€å‘ä½“éªŒ
2. æ»¡è¶³éƒ¨åˆ†ä¸šåŠ¡ç‹¬ç«‹ç»´æŠ¤å’Œå‘å¸ƒçš„éœ€æ±‚
3. é™ä½é¡¹ç›®å¤æ‚åº¦ï¼Œå‡å°‘è¿­ä»£æˆæœ¬

:::tip
**fms-adminã€smartsortingstaticã€smartsortingoperationstatic å¾®åº”ç”¨æ•°ç†**
:::

## webpackæ‰“åŒ…ä¼˜åŒ–
### fmsæ‰“åŒ…æ•ˆç‡ä¼˜åŒ–
1. åˆ†æåŒ…ä½“ç§¯ï¼šæ‰“åŒ…æ—¶é—´112sï¼Œå¤§å°20.81MB
2. éƒ¨åˆ†åŒ…ä½“ç§¯å¤§çš„å¼•å…¥`cdn`
:::tip
- å¹²æ‰ `element-ui`ï¼ŒåŒ…å¤§å°å˜ä¸º20.23MB
- `vue,vuex,vue-router` vueå…¨å®¶æ¡¶æ¥å…¥cdnåï¼Œå¤§å°ä¸º20.12MB
- `echarts`æ¥å…¥cdnåï¼Œä½“ç§¯å˜ä¸º19.72MB
- `xlsx.js`ï¼šå‡çº§ç‰ˆæœ¬ï¼Œç”±0.17.xå‡çº§åˆ°0.18.xï¼ˆæ”¯æŒtree-shaking`ï¼‰ã€‚å…¨é‡åŠ è½½æ”¹æˆæŒ‰éœ€åŠ è½½ã€‚æ‰“åŒ…æ—¶é—´å˜ä¸º80.7sï¼Œå¤§å°19.23MB
- ç¿»è¯‘èµ„æºJSONæ–‡ä»¶æ”¹æˆä½¿ç”¨ tsp
- acribusæ”¹æˆå¼‚æ­¥åŠ è½½
:::

3. é€šè¿‡`SplitChunk.maxSize`å°†è¶…è¿‡åˆ¶å®šå¤§å°çš„åŒ…å†è¿›è¡Œæ‹†åˆ†ï¼Œé…åˆ`http2`å¤šè·¯å¤ç”¨ç‰¹æ€§æ•ˆæœæ›´å¥½
4. å› ä¸ºacribusåŠä»£ç å¾ªç¯å†å²åŸå› ï¼Œæ²¡æœ‰ä½¿ç”¨`esbuild-loader`ä»£æ›¿`babel-loader`ï¼Œåªä½¿ç”¨`ESBuildMinifyPlugin`å‹ç¼©`js/css`ï¼Œæå‡ä¸å°‘é€Ÿåº¦

### æå‡æ‰“åŒ…æ•ˆç‡
1. ä½¿ç”¨`speed-measure-webpack-plugin`åˆ†æå¯åŠ¨è€—æ—¶
2. å¼•å…¥æ‡’ç¼–è¯‘`lazyCompilation`ï¼Œåªé’ˆå¯¹`views`æ–‡ä»¶è¿›è¡Œæ‡’ç¼–è¯‘ã€‚ï¼ˆè·³è½¬è·¯ç”±æ—¶è§¦å‘å¢é‡ç¼–è¯‘ï¼‰
> å¼•å…¥`webpack`çš„æ‡’ç¼–è¯‘ï¼Œé¦–æ¬¡å¯åŠ¨çš„æ—¶é—´(55.48sï¼‰é™ä¸ºä¹‹å‰çš„47%å·¦å³ï¼ˆç°åœ¨26.64sï¼‰ï¼Œæå‡äº†53%çš„æ•ˆç‡ã€‚é¦–æ¬¡è¿›å…¥é¡µé¢è€—ï¼ˆæ‰“å¼€æœ¬åœ°spxï¼‰æ—¶å†æ¬¡ç¼–è¯‘è€—æ—¶1.8sï¼Œè·³è½¬è·¯ç”±å†æ¬¡è§¦å‘ç¼–è¯‘è€—è´¹2.64sçš„æ—¶é—´ã€‚æ•´ä½“çš„æ•ˆæœç›¸æ¯”ä¼˜åŒ–å‰æœ‰æ˜æ˜¾çš„æå‡ã€‚ä½†æ˜¯ç”±äºæ¯æ¬¡è¿›å…¥æ–°çš„é¡µé¢éƒ½ä¼šè§¦å‘ç¼–è¯‘ï¼Œå¯¼è‡´ä½“éªŒæ„Ÿç¨å¾®é™ä½ã€‚
3. å‡å°‘ä¸å¿…è¦çš„å‹ç¼©ï¼Œå¯åŠ¨æ—¶é—´é™ä¸º22.001sï¼Œå‡å°‘4.63s
```js
optimization: {
  minimize: false,
}
```
4. å¢åŠ ç¼“å­˜æ–¹æ¡ˆï¼Œé¦–æ¬¡å¯åŠ¨æ€§èƒ½æœ‰æ‰€ä¸‹é™ï¼Œé¦–æ¬¡å¯åŠ¨æ—¶é—´ä¸Šå‡åˆ°27.43sï¼ŒäºŒæ¬¡å¯åŠ¨å¯åŠ¨æ—¶é—´ä¸º24.19s
```js
cache: {
  type: 'filesystem'
}
```

## fms LCPä¼˜åŒ–ä¸“é¡¹
LCP(largest contentful paint)ï¼Œä»7såˆ°3sã€‚ä»devtools -> performance insightså¯ä»¥çœ‹åˆ°

![img](/dovis-blog/other/88.png)

### ä¼˜åŒ–æªæ–½
å¼€å‘æ¨¡å¼ä¸‹
1. æŠŠæ‰€æœ‰å¿…é¡»çš„æ•°æ®è¯·æ±‚åˆ° `index.html` é¡µé¢æ‰§è¡Œã€‚
- å­åº”ç”¨ remoteEntry æ·»åŠ åˆ° preloadã€‚å‰ç½®åˆ°htmlä¸­åŠ è½½
- ajaxè¯·æ±‚ æ”¾åˆ° index.html

2. æ‡’åŠ è½½ acribus shcema

3. fms-adminä½¿ç”¨vueåŸºç¡€ç»„ä»¶åº“CDN
> é¦–å±åŠ è½½å­˜åœ¨ä¸€ä¸ªé˜¶æ®µï¼Œå¹¶è¡ŒåŠ è½½äº†å¤§é‡`js chunk`ï¼Œè€Œå…¶ä¸­å±äº`vue`åŸºç¡€ç»„ä»¶åº“çš„`chunkæ•°`é‡è¾ƒå¤šã€‚æ­¤å¤–ï¼Œåœ¨ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¸­ä¹Ÿå­˜åœ¨é‡å¤å¼•å…¥ç›¸åŒç»„ä»¶çš„æƒ…å†µã€‚é€šè¿‡å°†`vue`åŸºç¡€ç»„ä»¶åº“éƒ¨ç½²åˆ°`cdn`ï¼Œåœ¨`fms-admin`ç»Ÿä¸€ä½¿ç”¨`cdn`çš„ç»„ä»¶åº“èµ„æºï¼Œåˆ™å¯ä»¥ç¼“è§£è¿™äº›é—®é¢˜ã€‚

4. **å¯¹å„åˆå§‹åŒ–APIå¢åŠ IndexDBçš„ç¼“å­˜**
5. `cdn`ç¼“å­˜æ—¶é—´ä»ååˆ†é’Ÿæ”¹ä¸º7å¤©

:::tip
ä¼˜åŒ–å‰ä¸»åº”ç”¨chunk æ•°é‡121ä¸ªï¼Œå­åº”ç”¨éƒ¨åˆ†58ä¸ªã€‚ä¼˜åŒ–åä¸»åº”ç”¨chunkæ•°83ä¸ªï¼Œå­åº”ç”¨46ä¸ªã€‚
:::

### è®°å½•


